# 🎯 기출문제 RAG 기반 시험 문제 생성 및 질의 응답 챗봇

## 📋 프로젝트 개요

Azure OpenAI와 RAG를 활용한 **맞춤형 학습 시스템**. 기출문제 PDF를 업로드하면 벡터 데이터베이스에 저장하고, 이를 기반으로 새로운 문제를 생성하거나 기출문제를 그대로 출제할 수 있습니다.

### 🎯 핵심 가치
- **개인화 학습**: 기출문제 기반 맞춤형 문제 생성
- **자동화된 피드백**: 즉시 답변 평가 및 상세한 해설 제공
- **출처 추적**: 모든 답변에 대한 기출문제 출처 정보 제공
- **학습 효율성**: 오답노트를 통한 체계적인 학습 관리

---

## 🚀 주요 기능

### 📚 시험 관리
- **다중 시험 지원**: 여러 시험을 동시에 관리
- **PDF 업로드**: 기출문제 PDF 자동 처리 및 벡터화로 최신 시험 문제집이 없어도 공부 가능
- **중복 방지**: PDF 해시 기반 중복 업로드 방지
- **데이터 영속성**: 시험 정보 및 PDF 메타데이터 자동 저장

### 🎯 문제 생성 시스템
#### 1. 기출문제 기반 새 문제 생성
- **RAG 기반 생성**: 기출문제를 참고한 새로운 문제 생성
- **난이도 자동 조절**: 쉬움/보통/어려움 랜덤 출제
- **문제 유형 다양화**: 객관식/주관식 랜덤 출제
- **컨텍스트 검증**: 생성된 문제의 품질 자동 검증(검토 Agent)

#### 2. 기출문제 출제
- **문제 추출**: PDF에서 자동으로 문제 번호 및 내용 추출
- **균등 분배**: 모든 PDF에서 균등하게 문제 선택
- **중복 방지**: 최근 출제된 문제 자동 제외
- **출처 추적**: 문제별 정확한 PDF 출처 정보 제공

### ✏️ 답변 평가 시스템
- **RAG 기반 평가**: 기출문제 컨텍스트를 활용한 정확한 평가
- **상세한 피드백**: 정답 여부 및 개선점 제시
- **오답 자동 저장**: 틀린 문제를 오답노트에 자동 저장
- **해설 제공**: 정답과 상세한 해설 표시

### 💬 AI 챗봇 (RAG + LLM)
- **시험별 질의응답**: 선택한 시험의 기출문제 기반 답변
- **하이브리드 답변**: 기출문제 + LLM 지식 결합
- **정보 검증**: 에이전트 기반 답변 품질 검증
- **출처 정보**: 답변의 근거가 되는 기출문제 출처 제공

### 📝 오답노트 관리
- **Sequential Retry**: 틀린 문제를 순서대로 재도전
- **오답 통계**: 시험별 오답 횟수 및 통계 정보
- **정답 관리**: 오답 문제 정답 이후 삭제 가능

---

## 🏗️ 시스템 아키텍처

```
[사용자 (Gradio UI)]
        ↓
[PDF 업로드] → [Docling PDF 처리] → [문제 추출] → [FAISS 벡터 DB]
        ↓
[Azure OpenAI API]
        ↓
[RAG 기반 문제 생성/답변 평가]
        ↓
[결과 및 출처 정보]
        ↓
[Gradio UI 표시]
```

### 🔧 기술 스택

#### 핵심 기술
- **Azure OpenAI**: GPT-4.1 기반 자연어 처리
- **Gradio**: 직관적인 웹 인터페이스
- **FAISS**: 고성능 벡터 데이터베이스
- **Sentence Transformers**: 다국어 텍스트 임베딩
- **Docling**: 고품질 PDF 텍스트 추출
- **RAG**: 검색 기반 생성 모델

#### GPU 가속 지원
- **FAISS**: GPU 가속
- **Sentence Transformers**: GPU 가속으로 임베딩 속도 향상
- **Docling**: GPU 기반 OCR로 PDF 처리 속도 향상
- **자동 Fallback**: GPU 사용 불가 시 CPU로 자동 전환

---

## 🎨 사용자 인터페이스

### 📱 Gradio 기반 웹 인터페이스
- **탭 기반 구조**: 직관적인 기능별 탭 구성
- **반응형 디자인**: 다양한 화면 크기에 최적화

### 🔄 플로우
1. **시험 설정** → PDF 업로드 → 벡터 DB 구축
2. **문제 생성** → 답변 입력 → 평가 및 피드백
3. **AI 챗봇** → 질문 입력 → RAG 기반 답변
4. **오답 관리** → 재도전 → 학습 완료

---

## 🔬 기술적 특징

### 🧠 Prompting
- **모듈화된 프롬프트**: 기능별 프롬프트 분리 및 재사용
- **동적 프롬프트 생성**: 컨텍스트에 따른 프롬프트 최적화
- **품질 관리**: 프롬프트 기반 결과 검증

### 🤖 에이전트 기반 시스템
- **정보 검증 에이전트**: 답변 품질 자동 검증
- **문제 검토 에이전트**: 생성된 문제의 적절성 검토
- **확장 가능한 구조**: 새로운 에이전트 쉽게 추가 가능

### 📊 데이터 관리
- **벡터 데이터베이스**: FAISS 기반 고성능 검색
- **메타데이터 관리**: 문제별 상세 정보 저장
- **자동 백업**: 중요 데이터 자동 저장 및 복원

### 🔍 검색 최적화
- **다중 검색 전략**: 키워드 + 의미론적 검색 결합
- **관련성 점수**: 검색 결과의 관련성 자동 평가
- **하이브리드 답변**: 검색 결과 + LLM 지식 결합

---

## 📈 성능 최적화

### 💾 메모리 효율성
- **청크 기반 처리**: 대용량 PDF 청크 단위 처리
- **자동 정리**: 불필요한 데이터 자동 제거
- **메모리 모니터링**: 실시간 메모리 사용량 추적

### 🎯 정확도 향상
- **컨텍스트 검증**: 생성된 컨텍스트 품질 자동 검증
- **다중 검색**: 다양한 검색 쿼리로 정확도 향상
- **에이전트 검증**: AI 에이전트 기반 결과 검증

---

## 🔧 설치 및 실행

### 📋 요구사항
- Python 3.11 이상 (권장: Python 3.12)
- Azure OpenAI 서비스
- GPU 지원 (선택사항, 성능 향상)

### 🚀 빠른 시작
```bash
# 1. 저장소 클론
git clone https://github.com/ktds-jinseop-sim/ktds_ms_ai.git
cd mvp

# 2. 가상환경 생성 및 활성화
python -m venv .venv
.venv\Scripts\activate  # Windows
source .venv/bin/activate  # Linux/Mac

# 3. 의존성 설치
pip install -r requirements.txt

# 4. 환경 변수 설정 (.env 파일 생성)
OPENAI_API_KEY=your_api_key
AZURE_ENDPOINT=your_endpoint
DEPLOYMENT_NAME=your_deployment

# 5. 실행
python mvp_main.py
```

### 🌐 웹 접속
- 브라우저에서 `http://localhost:7860` 접속
- Gradio 인터페이스 확인

---

## 📁 프로젝트 구조

```
mvp/
├── mvp_main.py              # 메인 애플리케이션 (Gradio 인터페이스)
├── config.py                # 환경 변수 및 설정 관리
├── logger.py                # 로깅 시스템
├── prompt.py                # 프롬프트 정의 (Pythonic Prompting)
├── vector_store.py          # FAISS 벡터 스토어
├── pdf_processor.py         # PDF 처리 모듈 (Docling 활용)
├── review_agent_simple.py   # 문제 검토 에이전트
├── agents/                  # 에이전트 모듈
│   ├── base_agent.py        # 기본 에이전트 클래스
│   └── information_validation_agent.py  # 정보 검증 에이전트
├── requirements.txt         # 필요한 라이브러리
├── INSTALL.md              # 설치 가이드
├── README.md               # 프로젝트 설명
├── .env                    # 환경 변수 (사용자 생성)
├── faiss_vector_db/        # 벡터 데이터베이스 (자동 생성)
├── extracted_questions/    # 추출된 문제 저장소 (자동 생성)
├── logs/                   # 로그 파일 (자동 생성)
├── exam_data.json          # 시험 데이터 (자동 생성)
├── pdf_hashes.json         # PDF 해시 정보 (자동 생성)
└── wrong_answers.json      # 오답노트 데이터 (자동 생성)
```

---

## 🎯 특징

### 🚀 기술적 특징
1. **Prompting**: 모듈화된 프롬프트로 재사용성 극대화
2. **에이전트 기반 검증**: AI 에이전트를 통한 자동 품질 관리
3. **하이브리드 RAG**: 검색 + 생성 모델의 최적 조합
4. **GPU 가속**: 전체 파이프라인 GPU 최적화

### 🔮 확장 가능성
1. **다중 언어 지원**: 다양한 언어의 기출문제 처리
2. **사용자 관리**: 개인별 학습 진도 추적
3. **맞춤형 학습**: AI 기반 개인화 학습 경로 제안
4. **클라우드 배포**: Azure, AWS, On-premise, In-house 등 배포 제한X
5. **언어 모델 변경**: Qwen2.5-7B 급 Open Source 모델 엔드포인트 변경 후 추가적인 과금 X

### 🎓 교육적 가치
1. **학습 효율성**: 체계적인 오답 관리로 학습 효과 극대화
2. **자기주도학습**: 개인별 맞춤형 문제 제공
3. **신뢰성**: 기출문제 기반으로 높은 신뢰도
4. **접근성**: 책이 없는 시험도 준비 가능